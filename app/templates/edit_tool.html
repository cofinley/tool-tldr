{% extends "base.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block title %}Edit {{ tool.name }}{% endblock %}

{% block content %}
  <div class="page-header">
    <h1>Edit <a href={{ url_for("main.fetch_tool_page", tool_id=tool.id) }}>{{ tool.name }}</a></h1>
  </div>

  <div class="row">
    <form id="recaptcha-form" class="col-md-5" method="post">
      {% set max = 250 %}
      {% set edit_msg_max = 100 %}
      {{ form.hidden_tag() }}
      {{ wtf.form_errors(form, hiddens="only") }}

      {{ wtf.form_field(form.name) }}
      {% if is_confirmed %}
        <div class="form-group">
          {{ wtf.form_field(form.move_parent, checked=False) }}
        </div>
        <div id="optional_parent_field" class="initially-hidden-field">
          {{ wtf.form_field(form.parent_category, readonly=True) }}
        </div>
      {% endif %}

      {{ wtf.form_field(form.avatar_url) }}
      {{ wtf.form_field(form.env) }}
      {{ wtf.form_field(form.created, min="1970", max="2099", step="1", type="number") }}
      {{ wtf.form_field(form.project_version) }}
      {{ wtf.form_field(form.is_active) }}
      {{ wtf.form_field(form.link) }}
      {{ wtf.form_field(form.why) }}
      <span id="why-count" class="char-count text-muted">{{ max }}</span>
      {{ wtf.form_field(form.edit_msg, class="form-control edit-msg-input", maxlength=edit_msg_max) }}
      <span id="edit_msg-count" class="char-count text-muted">{{ edit_msg_max }}</span>
      {% if not is_confirmed %}
        <div id="edit-tool-recaptcha" class="my-3">
          {{ form.recaptcha }}
        </div>
      {% endif %}
      <div class="d-flex justify-content-end mb-5 w-100">
        <button type="button" class="btn btn-outline-danger mr-auto form-button cancel-button">Cancel</button>
        {% if not is_confirmed %}
          <button type="button" class="btn btn-success form-button" id="recaptcha-submit">Submit</button>
        {% else %}
          <input type="submit" class="btn btn-success form-button" id="recaptcha-submit" value="Submit" name="Submit">
        {% endif %}
      </div>
    </form>
    {% if is_confirmed %}
      <div id="tree-pane" class="col-md-7 initially-hidden-field">
        <label>Pick a parent category</label>
        <div id="explore-tree-edit" class="explore-tree" data-url="/explore_nodes?no-link=true"></div>
      </div>
    {% endif %}
  </div>
{% endblock %}
